{"ast":null,"code":"var _jsxFileName = \"/Users/dave/Public/5minutegames/src/utils/DataContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { games } from '../games';\nimport { dataService } from './dataService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DataContext = /*#__PURE__*/createContext();\nexport const DataProvider = ({\n  children\n}) => {\n  _s();\n  const today = new Date().toISOString().split(\"T\")[0];\n  dataService.init(today);\n  const [userData, setUserData] = useState(null);\n  const [gameIdPlayEditing, setGameIdPlayEditing] = useState(null);\n\n  // Check user authentication state on load\n  useEffect(() => {\n    return dataService.checkAutoLogin(setUserData);\n  }, []);\n  const signInWithGoogle = async onComplete => {\n    try {\n      await dataService.signInWithGoogle();\n      onComplete();\n    } catch (error) {\n      console.error(\"Error signing in with Google:\", error);\n    }\n  };\n  const signOutUser = async () => {\n    try {\n      await dataService.signOutUser();\n      setUserData(null);\n    } catch (error) {\n      console.error(\"Error signing out:\", error);\n    }\n  };\n  const signUpWithEmail = async (email, password, username, character, color, onComplete) => {\n    try {\n      const newUserData = await dataService.signUpWithEmail(email, password, username, character, color);\n      setUserData(newUserData);\n      onComplete();\n    } catch (error) {\n      console.error(\"Error signing up:\", error.message);\n    }\n  };\n  const signInWithEmail = async (email, password, onComplete) => {\n    try {\n      const newUserData = await dataService.signInWithEmail(email, password);\n      console.log(\"sign in\", newUserData);\n      setUserData(newUserData);\n      onComplete();\n    } catch (error) {\n      console.error(\"Error signing in:\", error.message);\n    }\n  };\n  const setPreferences = async newPreferences => {\n    try {\n      await dataService.setPreferences(newPreferences);\n      const newUserData = {\n        ...userData,\n        preferences: newPreferences\n      };\n      setUserData(newUserData);\n    } catch (error) {\n      console.error(\"Error updating preferences:\", error);\n    }\n  };\n  const setFavorites = async newFavorites => {\n    try {\n      await dataService.setFavorites(newFavorites);\n      const newUserData = {\n        ...userData,\n        favorites: newFavorites\n      };\n      setUserData(newUserData);\n    } catch (error) {\n      console.error(\"Error updating favorites:\", error);\n    }\n  };\n  function addFavorite(id) {\n    const newFavorites = [...userData.favorites];\n    newFavorites.push(id);\n    setFavorites(newFavorites);\n  }\n  function removeFavorite(id) {\n    const newFavorites = userData.favorites.filter(item => item != id);\n    setFavorites(newFavorites);\n  }\n  const setFriends = async newFriendIds => {\n    try {\n      await dataService.setFriends(newFriendIds);\n      const newUserData = await dataService.loadData();\n      console.log(newUserData);\n      setUserData(newUserData);\n    } catch (error) {\n      console.error(\"Error updating friends:\", error);\n    }\n  };\n  async function addFriend(username) {\n    const newFriends = [...userData.friends];\n    const newFriendData = await dataService.findUserByUsername(username);\n    if (newFriendData) {\n      newFriends.push(newFriendData);\n      setUserData(prevUserData => ({\n        ...prevUserData,\n        friends: newFriends\n      }));\n      return true;\n    } else return false;\n  }\n  async function removeFriend(id) {\n    const newFriends = userData.friends.filter(item => item.id != id);\n    console.log(\"remove:\" + id, newFriends);\n    const newFriendIds = newFriends.map(f => f.id);\n    setFriends(newFriendIds);\n  }\n  function setGameToEditPlay(id) {\n    setGameIdPlayEditing(id);\n  }\n  async function updatePlay(score, message) {\n    console.log(\"update play:\" + score + \" --- \" + message);\n    try {\n      await dataService.updatePlay(gameIdPlayEditing, score, message);\n      const newTodayPlays = {\n        ...userData.todayPlays\n      };\n      newTodayPlays[gameIdPlayEditing] = {\n        score,\n        message\n      };\n      console.log(newTodayPlays);\n      const newUserData = {\n        ...userData,\n        todayPlays: newTodayPlays\n      };\n      setUserData(newUserData);\n    } catch (error) {\n      console.error(\"Error updating preferences:\", error);\n    }\n    setGameIdPlayEditing(null);\n  }\n  async function cancelEditPlay() {\n    setGameIdPlayEditing(null);\n  }\n  return /*#__PURE__*/_jsxDEV(DataContext.Provider, {\n    value: {\n      signInWithGoogle,\n      signOutUser,\n      signUpWithEmail,\n      signInWithEmail,\n      games,\n      userData,\n      setPreferences,\n      addFavorite,\n      removeFavorite,\n      addFriend,\n      removeFriend,\n      setGameToEditPlay,\n      gameIdPlayEditing,\n      updatePlay,\n      cancelEditPlay\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 152,\n    columnNumber: 9\n  }, this);\n};\n_s(DataProvider, \"99pfOzDrDU7f+cHXjUAz8sYxMhk=\");\n_c = DataProvider;\nexport const useData = () => {\n  _s2();\n  return useContext(DataContext);\n};\n_s2(useData, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"DataProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","games","dataService","jsxDEV","_jsxDEV","DataContext","DataProvider","children","_s","today","Date","toISOString","split","init","userData","setUserData","gameIdPlayEditing","setGameIdPlayEditing","checkAutoLogin","signInWithGoogle","onComplete","error","console","signOutUser","signUpWithEmail","email","password","username","character","color","newUserData","message","signInWithEmail","log","setPreferences","newPreferences","preferences","setFavorites","newFavorites","favorites","addFavorite","id","push","removeFavorite","filter","item","setFriends","newFriendIds","loadData","addFriend","newFriends","friends","newFriendData","findUserByUsername","prevUserData","removeFriend","map","f","setGameToEditPlay","updatePlay","score","newTodayPlays","todayPlays","cancelEditPlay","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useData","_s2","$RefreshReg$"],"sources":["/Users/dave/Public/5minutegames/src/utils/DataContext.js"],"sourcesContent":["\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { games } from '../games';\nimport { dataService } from './dataService';\n\n\nconst DataContext = createContext();\n\nexport const DataProvider = ({ children }) => {\n\n    const today = new Date().toISOString().split(\"T\")[0];\n    dataService.init(today);\n\n    const [userData, setUserData] = useState(null);\n    const [gameIdPlayEditing, setGameIdPlayEditing] = useState(null);\n  \n    // Check user authentication state on load\n    useEffect(() => {\n        return dataService.checkAutoLogin(setUserData);\n    }, []);\n\n    const signInWithGoogle = async (onComplete) => {\n        try {\n            await dataService.signInWithGoogle();\n            onComplete();\n        }\n        catch  (error) {\n            console.error(\"Error signing in with Google:\", error);\n        }\n    };\n      \n    const signOutUser = async () => {\n        try {\n            await dataService.signOutUser();\n            setUserData(null);\n        } catch (error) {\n            console.error(\"Error signing out:\", error);\n        }\n    };\n      \n    const signUpWithEmail = async (email, password, username, character, color, onComplete) => {\n        try {\n            const newUserData = await dataService.signUpWithEmail(email, password, username, character, color);\n            setUserData(newUserData);\n            onComplete();\n        } catch (error) {\n          console.error(\"Error signing up:\", error.message);\n        }\n    };\n      \n    const signInWithEmail = async (email, password, onComplete) => {\n        try {\n            const newUserData = await dataService.signInWithEmail(email, password);\n            console.log(\"sign in\",newUserData)\n            setUserData(newUserData);\n            onComplete();\n        } catch (error) {\n            console.error(\"Error signing in:\", error.message);\n        }\n    };\n      \n    const setPreferences = async (newPreferences) => {\n        try {\n            await dataService.setPreferences(newPreferences);\n            const newUserData = { ...userData, preferences: newPreferences };\n            setUserData(newUserData);\n        } catch (error) {\n            console.error(\"Error updating preferences:\", error);\n        }\n    }\n\n    const setFavorites = async (newFavorites) => {\n        try {\n            await dataService.setFavorites(newFavorites);\n            const newUserData = { ...userData, favorites: newFavorites };\n            setUserData(newUserData);\n        } catch (error) {\n            console.error(\"Error updating favorites:\", error);\n        }\n    }\n\n    function addFavorite(id) {\n        const newFavorites = [...userData.favorites];\n        newFavorites.push(id);\n        setFavorites(newFavorites);\n    }\n\n    function removeFavorite(id) {\n        const newFavorites = userData.favorites.filter(item => item != id);\n        setFavorites(newFavorites);\n    }\n\n    const setFriends = async (newFriendIds) => {\n        try {\n            await dataService.setFriends(newFriendIds);\n            const newUserData = await dataService.loadData();\n            console.log(newUserData);\n            setUserData(newUserData);\n        } catch (error) {\n            console.error(\"Error updating friends:\", error);\n        }\n    }\n\n    async function addFriend(username) {\n        const newFriends = [...userData.friends];\n        const newFriendData = await dataService.findUserByUsername(username);\n        if (newFriendData){\n            newFriends.push(newFriendData);\n            setUserData(prevUserData => ({\n                ...prevUserData,\n                friends: newFriends\n            }));\n            return true;\n        }\n        else return false;\n    }\n\n    async function removeFriend(id) {\n        const newFriends = userData.friends.filter(item => item.id != id);\n        console.log(\"remove:\"+id, newFriends);\n        const newFriendIds = newFriends.map( f=> f.id );\n        setFriends(newFriendIds);\n    }\n\n    function setGameToEditPlay(id) {\n        setGameIdPlayEditing(id);\n    }\n\n    async function updatePlay(score, message) {\n        console.log(\"update play:\"+score+\" --- \"+message);\n\n        try {\n            await dataService.updatePlay(gameIdPlayEditing, score, message);\n            \n            const newTodayPlays = {...userData.todayPlays};\n            newTodayPlays[gameIdPlayEditing] = {score, message};\n            console.log(newTodayPlays);\n            const newUserData = { ...userData, todayPlays: newTodayPlays };\n            setUserData(newUserData);\n        } catch (error) {\n            console.error(\"Error updating preferences:\", error);\n        }\n\n        setGameIdPlayEditing(null);\n    }\n\n    async function cancelEditPlay() {\n        setGameIdPlayEditing(null);\n    }\n  \n    return (\n        <DataContext.Provider value={{ \n            signInWithGoogle, \n            signOutUser, \n            signUpWithEmail, \n            signInWithEmail,\n            games,\n            userData,\n            setPreferences,\n            addFavorite,\n            removeFavorite,\n            addFriend,\n            removeFriend,\n            setGameToEditPlay,\n            gameIdPlayEditing,\n            updatePlay,\n            cancelEditPlay\n        }}>\n            {children}\n        </DataContext.Provider>\n    );\n  };\n\n  export const useData = () => useContext(DataContext);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}